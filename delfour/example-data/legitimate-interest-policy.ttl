@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix dpv: <http://www.w3.org/ns/dpv#> .
@prefix dpv-odrl: <https://w3id.org/dpv/mappings/odrl#> .
@prefix eu-gdpr:  <https://w3id.org/dpv/legal/eu/gdpr#> .
@prefix ex: <http://example.org/> .
@prefix odrl: <http://www.w3.org/ns/odrl/2/> .

<urn:uuid:legitimate-interest-policy> a odrl:Agreement ;
  dcterms:description "Instantiated policy that allows Delfour to keep pseudo-anomymised data about users' purchasing habits under legitimate interest." ;
  odrl:permission <urn:uuid:purchasing-habits-permission> .

<urn:uuid:purchasing-habits-permission> a odrl:Permission ;
  odrl:action odrl:read, odrl:archive ;
  odrl:target ex:shoppingList ; # TBD: the actual location is still required
  odrl:assignee ex:delfour ;
  odrl:assigner <https://ruben.verborgh.org/profile/#me> ;
  odrl:constraint <urn:uuid:legitimate-interest-legal-basis>, <urn:uuid:improve-services-purpose> ;
  odrl:duty <urn:uuid:pseudo-anonymisation-duty> .

<urn:uuid:legitimate-interest-legal-basis> a odrl:Constraint ;
  odrl:leftOperand dpv-odrl:LegalBasis ;
  odrl:operator odrl:eq ;
  odrl:rightOperand eu-gdpr:A6-1-f .

<urn:uuid:improve-services-purpose> a odrl:Constraint ;
  odrl:leftOperand odrl:purpose ;
  odrl:operator odrl:eq ;
  odrl:rightOperand dpv:ImproveExistingProductsAndServices .

<urn:uuid:pseudo-anonymisation-constraint> a odrl:Duty ;
  odrl:action dpv-odrl:Pseudonymisation ;
  odrl:target ex:shoppingList ;
  odrl:assignee ex:delfour ;
  odrl:assigner <https://ruben.verborgh.org/profile/#me> ;
  odrl:constraint <urn:uuid:temporalConstraint> .

<urn:uuid:temporalConstraint> a odrl:Constraint ;
  odrl:leftOperand odrl:dateTime ;
  odrl:operator odrl:lt ;
  odrl:rightOperand "2024-02-12T11:20:10.999Z"^^<http://www.w3.org/2001/XMLSchema#dateTime> . # NOTE: should represent the timestamp after scanner is put back in place; This time could be better encoded with the dynamic policy feature (but for now that might complicate stuff)