@prefix dcterms:  <http://purl.org/dc/terms/> .
@prefix dpv:      <https://w3id.org/dpv#> .
@prefix dpv-odrl: <https://w3id.org/dpv/mappings/odrl#> .
@prefix eu-gdpr:  <https://w3id.org/dpv/legal/eu/gdpr#> .
@prefix ex:       <https://example.org/> .
@prefix odrl:     <http://www.w3.org/ns/odrl/2/> .
@prefix rdf:      <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd:      <http://www.w3.org/2001/XMLSchema#> .

<urn:uuid:prefences-policy> a odrl:Agreement ;
  dcterms:description "Instantiated policy that allows shopping preferences to be read to show alternative products." ;
  odrl:permission <urn:uuid:preference-permission> .

<urn:uuid:preference-permission> a odrl:Permission ;
  odrl:action odrl:read ;
  odrl:target ex:preferences ; # TBD: the actual location is still required
  odrl:assignee ex:delfour ;
  odrl:assigner <https://ruben.verborgh.org/profile/#me> ;
  odrl:constraint <urn:uuid:purposeConstraint>, <urn:uuid:legalBasisConstraint> ;
  odrl:duty <urn:uuid:delete-duty> .

<urn:uuid:purposeConstraint> a odrl:Constraint ;
  odrl:leftOperand odrl:purpose ;
  odrl:operator odrl:eq ;
  odrl:rightOperand dpv:ProvideProductRecommendations .
  
<urn:uuid:legalBasisConstraint> a odrl:Constraint ;
  odrl:leftOperand dpv-odrl:LegalBasis ;
  odrl:operator odrl:eq ;
  odrl:rightOperand eu-gdpr:A6-1-a .

<urn:uuid:delete-duty> a odrl:Duty ;
  odrl:action odrl:delete ;
  odrl:target ex:preferences ;  # TBD: the actual location is still required
  odrl:assignee ex:delfour ;
  odrl:assigner <https://ruben.verborgh.org/profile/#me> ;
  odrl:constraint <urn:uuid:temporalConstraint> .

<urn:uuid:temporalConstraint> a odrl:Constraint ;
  odrl:leftOperand odrl:dateTime ;
  odrl:operator odrl:lt ;
  odrl:rightOperand "2024-02-12T11:20:10.999Z"^^xsd:dateTime .  # NOTE: should represent the timestamp after scanner is put back in place; This time could be better encoded with the dynamic policy feature (but for now that might complicate stuff)